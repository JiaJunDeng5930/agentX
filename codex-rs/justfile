set positional-arguments

# Display help
help:
    just -l

# `codex`
codex *args:
    cargo run --bin codex -- "$@"

# `codex exec`
exec *args:
    cargo run --bin codex -- exec "$@"

# `codex tui`
tui *args:
    cargo run --bin codex -- tui "$@"

# Run the CLI version of the file-search crate.
file-search *args:
    cargo run --bin codex-file-search -- "$@"

# format code
fmt:
    if rustup toolchain list | grep -q nightly; then \
        echo "Using nightly rustfmt (enables imports_granularity=Item)"; \
        cargo +nightly fmt --all -- --config-path rustfmt.toml; \
    else \
        echo "Nightly toolchain not found; using stable rustfmt without unstable options"; \
        cargo fmt --all -- --config-path rustfmt.stable.toml; \
    fi

fix *args:
    cargo clippy --fix --all-features --tests --allow-dirty "$@"

install:
    rustup show active-toolchain
    cargo fetch
